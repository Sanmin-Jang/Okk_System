<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ОКК в iframe</title>
<style>
  html, body { margin: 0; padding: 0; height: 100%; }
  iframe { width: 100%; height: 100vh; border: none; }
</style>
</head>
<body>

<iframe id="appFrame" src=""></iframe>

<script>
  const baseUrl = "https://script.google.com/macros/s/AKfycbzU-7LoOARRcgPdAFNeQP24bafaHIjmVLkJNOwdNt713_ALRTgSYJCPmPwXGdCl3qqT/exec";
  const iframe = document.getElementById('appFrame');

  // Список доступных страниц
  const pages = [
    'Control', 'Analytics', 'Index', 'Scoring', 'Operators', 'Clinics',
    'KedmaAstana', 'FashionAstana', 'KedmaAlmaty',
    'ErrorKedmaAstana', 'ErrorKedmaAlmaty', 'ErrorFashionAstana', 'Main'
  ];

  // Начальная страница
  iframe.src = `${baseUrl}?page=Main`;

  // Перехват кликов на ссылках или элементах с data-page
  document.addEventListener('click', function(e) {
    // ищем ближайший элемент с data-page или ссылку
    const target = e.target.closest('[data-page], a');
    if (!target) return;

    let page = target.getAttribute('data-page') || target.getAttribute('href');
    if (!page) return;

    // проверяем, есть ли страница в списке
    page = pages.find(p => page.includes(p));
    if (!page) return;

    e.preventDefault(); // блокируем обычный переход
    iframe.src = `${baseUrl}?page=${encodeURIComponent(page)}`;
  });
</script>

</body>
</html>
